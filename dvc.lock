schema: '2.0'
stages:
  predictions_wise_wolf_pyro_sdis_val:
    cmd:
    - uv run ./scripts/predict.py --save-dir ./data/interim/pyro-sdis/val/predictions/wise_wolf/
      --dir-images "./data/raw/pyro-sdis/images/val/" --filepath-weights ./data/external/models/wise_wolf/weights/yolov11s.pt
      --loglevel "info"
    deps:
    - path: ./data/external/models/wise_wolf/weights/yolov11s.pt
      hash: md5
      md5: 1b692922ce755191e20bb29d9ed8fad3
      size: 19261779
    - path: ./data/raw/pyro-sdis/images/val/
      hash: md5
      md5: 128120c2d9dfc1ac5ad01b0a9f38c0e4.dir
      size: 390351269
      nfiles: 4099
    - path: ./scripts/predict.py
      hash: md5
      md5: 6d87c7e59affd8369c95f3f307880f7b
      size: 3263
    outs:
    - path: ./data/interim/pyro-sdis/val/predictions/wise_wolf/
      hash: md5
      md5: da4df9caec95bf99b333d59321e5b5a8.dir
      size: 417720
      nfiles: 4099
  data_pyro_sdis_testset:
    cmd:
    - uv run ./scripts/install_local_huggingface_dataset.py --save-dir "./data/raw/pyro-sdis-testset/"
      --data-dir "./data/raw/pyro-sdis-testset-parquet/" --loglevel "info"
    deps:
    - path: ./data/raw/pyro-sdis-testset-parquet/
      hash: md5
      md5: 7b9d1f53b6b88d8233a90299969e3602.dir
      size: 408292029
      nfiles: 1
    - path: ./scripts/install_local_huggingface_dataset.py
      hash: md5
      md5: cc1d183f41bd336c5fe486e5bf433fa6
      size: 3225
    outs:
    - path: ./data/raw/pyro-sdis-testset/
      hash: md5
      md5: 694357d359cc048f59eeb3b1a85e47ee.dir
      size: 408834037
      nfiles: 7780
  predictions_legendary_field_pyro_sdis_val:
    cmd:
    - uv run ./scripts/predict.py --save-dir ./data/interim/pyro-sdis/val/predictions/legendary_field/
      --dir-images "./data/raw/pyro-sdis/images/val/" --filepath-weights ./data/external/models/legendary_field/weights/legendary-field-19.pt
      --loglevel "info"
    deps:
    - path: ./data/external/models/legendary_field/weights/legendary-field-19.pt
      hash: md5
      md5: ef2fb126dda23c82745a769e91b2a637
      size: 22510190
    - path: ./data/raw/pyro-sdis/images/val/
      hash: md5
      md5: 128120c2d9dfc1ac5ad01b0a9f38c0e4.dir
      size: 390351269
      nfiles: 4099
    - path: ./scripts/predict.py
      hash: md5
      md5: 6d87c7e59affd8369c95f3f307880f7b
      size: 3263
    outs:
    - path: ./data/interim/pyro-sdis/val/predictions/legendary_field/
      hash: md5
      md5: 29ae18381c0489c7eb0be60273861907.dir
      size: 321740
      nfiles: 4099
  crops_wise_wolf_pyro_sdis_val:
    cmd:
    - uv run ./scripts/crop_with_prediction.py --save-dir ./data/interim/pyro-sdis/val/crops/wise_wolf/
      --target-size 224 --dir-images ./data/raw/pyro-sdis/images/val/ --dir-predictions
      ./data/interim/pyro-sdis/val/predictions/wise_wolf --loglevel "info"
    deps:
    - path: ./data/interim/pyro-sdis/val/predictions/wise_wolf
      hash: md5
      md5: da4df9caec95bf99b333d59321e5b5a8.dir
      size: 417720
      nfiles: 4099
    - path: ./data/raw/pyro-sdis/images/val/
      hash: md5
      md5: 128120c2d9dfc1ac5ad01b0a9f38c0e4.dir
      size: 390351269
      nfiles: 4099
    - path: ./scripts/crop_with_prediction.py
      hash: md5
      md5: ebaefa0b94c1ca22e7bc33373c7d86b7
      size: 7484
    outs:
    - path: ./data/interim/pyro-sdis/val/crops/wise_wolf/
      hash: md5
      md5: c5142e27ac91ff9172b79df703f2667e.dir
      size: 64094144
      nfiles: 8423
  predictions_wise_wolf_FP_2024:
    cmd:
    - uv run ./scripts/predict.py --save-dir ./data/interim/FP_2024/predictions/wise_wolf/
      --dir-images ./data/raw/FP_2024/ --filepath-weights ./data/external/models/wise_wolf/weights/yolov11s.pt
      --loglevel "info"
    deps:
    - path: ./data/external/models/wise_wolf/weights/yolov11s.pt
      hash: md5
      md5: 1b692922ce755191e20bb29d9ed8fad3
      size: 19261779
    - path: ./data/raw/FP_2024/
      hash: md5
      md5: 66f296ca12df64fbf69dffbc5ea85b75.dir
      size: 19970165665
      nfiles: 137840
    - path: ./scripts/predict.py
      hash: md5
      md5: 6d87c7e59affd8369c95f3f307880f7b
      size: 3263
    outs:
    - path: ./data/interim/FP_2024/predictions/wise_wolf/
      hash: md5
      md5: 013c3108623fc8a18df79c6975bee9d4.dir
      size: 586769
      nfiles: 136327
  crops_wise_wolf_FP_2024:
    cmd:
    - uv run ./scripts/crop_with_prediction.py --save-dir ./data/interim/FP_2024/crops/wise_wolf/
      --target-size 224 --dir-images ./data/raw/FP_2024/ --dir-predictions ./data/interim/FP_2024/predictions/wise_wolf
      --loglevel "info"
    deps:
    - path: ./data/interim/FP_2024/predictions/wise_wolf
      hash: md5
      md5: 013c3108623fc8a18df79c6975bee9d4.dir
      size: 586769
      nfiles: 136327
    - path: ./data/raw/FP_2024/
      hash: md5
      md5: 66f296ca12df64fbf69dffbc5ea85b75.dir
      size: 19970165665
      nfiles: 137840
    - path: ./scripts/crop_with_prediction.py
      hash: md5
      md5: ebaefa0b94c1ca22e7bc33373c7d86b7
      size: 7484
    outs:
    - path: ./data/interim/FP_2024/crops/wise_wolf/
      hash: md5
      md5: a95b76a27bd701bbab6249fe38636cdd.dir
      size: 130402686
      nfiles: 11861
  filter_data_pyrosdis_smoke:
    cmd:
    - uv run ./scripts/filter_data_pyrosdis_smoke.py --save-dir ./data/interim/filtered/smoke/pyro-sdis/
      --dir-dataset ./data/raw/pyro-sdis/ --loglevel "info"
    deps:
    - path: ./data/raw/pyro-sdis/
      hash: md5
      md5: b2315192e7f9ec2c619365b054af1d49.dir
      size: 3284791992
      nfiles: 67272
    - path: ./scripts/filter_data_pyrosdis_smoke.py
      hash: md5
      md5: 00b30e4d298f4bd3ac895178566b071a
      size: 4969
    outs:
    - path: ./data/interim/filtered/smoke/pyro-sdis/
      hash: md5
      md5: aa679d6d979b824a9864839d220c4566.dir
      size: 2758576581
      nfiles: 56274
  filter_data_figlib_smoke:
    cmd:
    - uv run ./scripts/filter_data_figlib_smoke.py --save-dir ./data/interim/filtered/smoke/FIGLIB_ANNOTATED_RESIZED/
      --dir-dataset ./data/raw/FIGLIB_ANNOTATED_RESIZED/ --loglevel "info"
    deps:
    - path: ./data/raw/FIGLIB_ANNOTATED_RESIZED/
      hash: md5
      md5: f0d52fbcb9869713a0c8c0960b2bef25.dir
      size: 3317314396
      nfiles: 49516
    - path: ./scripts/filter_data_figlib_smoke.py
      hash: md5
      md5: 0dce8c19627adab34f1e0ca8fc478825
      size: 4640
    outs:
    - path: ./data/interim/filtered/smoke/FIGLIB_ANNOTATED_RESIZED/
      hash: md5
      md5: 5aa650d552c162cfd440daa72d702edf.dir
      size: 1357857659
      nfiles: 20436
  filter_data_pyronear_ds_smoke:
    cmd:
    - uv run ./scripts/filter_data_pyronear_ds_smoke.py --save-dir ./data/interim/filtered/smoke/pyronear_ds_03_2024/
      --allowed-dataset-prefixes "pyronear" "awf" "random" "adf" --dir-dataset ./data/raw/pyronear_ds_03_2024/
      --loglevel "info"
    deps:
    - path: ./data/raw/pyronear_ds_03_2024/
      hash: md5
      md5: 6bcff221686ce4f5139eb6089cc31415.dir
      size: 2487440765
      nfiles: 33527
    - path: ./scripts/filter_data_pyronear_ds_smoke.py
      hash: md5
      md5: bc8cc48f72e919803fb8594b584426f7
      size: 5492
    outs:
    - path: ./data/interim/filtered/smoke/pyronear_ds_03_2024/
      hash: md5
      md5: fe0e0b734ada24d9199df560618ef78e.dir
      size: 1064743236
      nfiles: 18678
  split_data_figlib:
    cmd:
    - uv run ./scripts/split_figlib.py --save-dir ./data/interim/data-split/smoke/FIGLIB_ANNOTATED_RESIZED/
      --dir-dataset ./data/interim/filtered/smoke/FIGLIB_ANNOTATED_RESIZED/ --random-seed
      0 --ratio-train-val 0.9 --loglevel "info"
    deps:
    - path: ./data/interim/filtered/smoke/FIGLIB_ANNOTATED_RESIZED/
      hash: md5
      md5: 5aa650d552c162cfd440daa72d702edf.dir
      size: 1357857659
      nfiles: 20436
    - path: ./scripts/split_figlib.py
      hash: md5
      md5: 277edf4e7318507bb3d4ac16a655aa8c
      size: 5885
    outs:
    - path: ./data/interim/data-split/smoke/FIGLIB_ANNOTATED_RESIZED/
      hash: md5
      md5: cbf433f52ca543419891ffef35ec7a09.dir
      size: 1351043118
      nfiles: 20344
  merge_smoke_datasets:
    cmd:
    - uv run ./scripts/merge_smoke_datasets.py --save-dir ./data/interim/data-split/smoke/wildfire/
      --dir-datasets ./data/interim/data-split/smoke/FIGLIB_ANNOTATED_RESIZED/ ./data/interim/filtered/smoke/pyro-sdis/
      ./data/interim/filtered/smoke/pyronear_ds_03_2024/ --loglevel "info"
    deps:
    - path: ./data/interim/data-split/smoke/FIGLIB_ANNOTATED_RESIZED/
      hash: md5
      md5: cbf433f52ca543419891ffef35ec7a09.dir
      size: 1351043118
      nfiles: 20344
    - path: ./data/interim/filtered/smoke/pyro-sdis/
      hash: md5
      md5: aa679d6d979b824a9864839d220c4566.dir
      size: 2758576581
      nfiles: 56274
    - path: ./data/interim/filtered/smoke/pyronear_ds_03_2024/
      hash: md5
      md5: fe0e0b734ada24d9199df560618ef78e.dir
      size: 1064743236
      nfiles: 18678
    - path: ./scripts/merge_smoke_datasets.py
      hash: md5
      md5: 15bc4092ccc3d46aa717fbfa42289d37
      size: 4015
    outs:
    - path: ./data/interim/data-split/smoke/wildfire/
      hash: md5
      md5: 9c812eda9cd8d5ec73e00582b55601a1.dir
      size: 5174362935
      nfiles: 95296
  filter_data_false_positives_FP_2024:
    cmd:
    - uv run ./scripts/filter_data_false_positives.py --save-dir ./data/interim/filtered/false_positives/FP_2024/wise_wolf/
      --dir-dataset ./data/raw/FP_2024/ --dir-predictions ./data/interim/FP_2024/predictions/wise_wolf/
      --loglevel "info"
    deps:
    - path: ./data/interim/FP_2024/predictions/wise_wolf/
      hash: md5
      md5: 013c3108623fc8a18df79c6975bee9d4.dir
      size: 586769
      nfiles: 136327
    - path: ./data/raw/FP_2024/
      hash: md5
      md5: 66f296ca12df64fbf69dffbc5ea85b75.dir
      size: 19970165665
      nfiles: 137840
    - path: ./scripts/filter_data_figlib_smoke.py
      hash: md5
      md5: 0dce8c19627adab34f1e0ca8fc478825
      size: 4640
    outs:
    - path: ./data/interim/filtered/false_positives/FP_2024/wise_wolf/
      hash: md5
      md5: 50c15d23e0943c6f16c81308cee768f7.dir
      size: 765800833
      nfiles: 5484
  split_data_false_positives_FP_2024:
    cmd:
    - uv run ./scripts/split_false_positives.py --save-dir ./data/interim/data-split/false_positives/FP_2024/wise_wolf/
      --dir-dataset ./data/interim/filtered/false_positives/FP_2024/wise_wolf/ --random-seed
      0 --ratio-train-val 0.9 --ratio-val-test 0.5 --loglevel "info"
    deps:
    - path: ./data/interim/filtered/false_positives/FP_2024/wise_wolf/
      hash: md5
      md5: 50c15d23e0943c6f16c81308cee768f7.dir
      size: 765800833
      nfiles: 5484
    - path: ./scripts/split_false_positives.py
      hash: md5
      md5: 497ba59a8e7eb7c95b0613131ed50d4f
      size: 6336
    outs:
    - path: ./data/interim/data-split/false_positives/FP_2024/wise_wolf/
      hash: md5
      md5: 691e5675161bcf4f5855e2c71ee2f401.dir
      size: 762750699
      nfiles: 10922
